<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo 3 Prompt Tool Pro v2 - ƒêa Nh√¢n V·∫≠t & API</title>
    <style>
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        h1, h2 { text-align: center; }
        .section { background: rgba(255,255,255,0.15); padding: 20px; margin: 20px 0; border-radius: 10px; }
        label { display: block; margin: 10px 0 5px; font-weight: bold; }
        input, textarea, select { width: 100%; padding: 10px; border: none; border-radius: 5px; margin-bottom: 15px; font-size: 16px; }
        button { background: #ff6b6b; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #ff5252; }
        .char-list { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; }
        .char-card { background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; width: 200px; text-align: center; }
        .char-card img { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 10px; }
        .char-card button { background: #4caf50; font-size: 12px; padding: 8px; }
        .output { background: #fff; color: #333; padding: 15px; border-radius: 5px; min-height: 100px; white-space: pre-wrap; margin-top: 20px; }
        .copy-btn { background: #4caf50; }
        .small-btn { font-size: 12px; padding: 6px 10px; }
        footer { text-align: center; margin-top: 40px; opacity: 0.8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Veo 3 Prompt Tool Pro v2</h1>
        <p style="text-align:center;">H·ªó tr·ª£ nhi·ªÅu nh√¢n v·∫≠t t∆∞∆°ng t√°c ‚Ä¢ Style & Aspect Ratio ‚Ä¢ API & Reference Image</p>

        <!-- Ph·∫ßn 1: Qu·∫£n l√Ω nh√¢n v·∫≠t (gi·ªØ nguy√™n) -->
        <div class="section">
            <h2>1. Th∆∞ Vi·ªán Nh√¢n V·∫≠t</h2>
            <div id="characterList" class="char-list"></div>

            <h3>Th√™m Nh√¢n V·∫≠t M·ªõi</h3>
            <label>T√™n nh√¢n v·∫≠t</label>
            <input type="text" id="newCharName" placeholder="Nh√¢n v·∫≠t 1">

            <label>Upload ·∫£nh ho·∫∑c link URL</label>
            <input type="file" id="charImage" accept="image/*">
            <input type="text" id="charImageUrl" placeholder="https://example.com/image.jpg">

            <label>M√¥ t·∫£ th√™m</label>
            <textarea id="userDesc" rows="2" placeholder="Th√™m chi ti·∫øt..."></textarea>

            <button onclick="addOrUpdateCharacter()">‚ûï Th√™m / C·∫≠p Nh·∫≠t</button>
            <button onclick="analyzeImage()" class="small-btn">üîç Ph√¢n t√≠ch ·∫£nh</button>

            <div class="output" id="analysisOutput"></div>
        </div>

        <!-- Ph·∫ßn 2: T·∫°o Prompt Video (c·∫≠p nh·∫≠t m·ªõi) -->
        <div class="section">
            <h2>2. T·∫°o Prompt Video</h2>
            <label>Ch·ªçn nh√¢n v·∫≠t (c√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë·ªÉ t∆∞∆°ng t√°c)</label>
            <select id="selectedCharacters" multiple>
                <!-- Options s·∫Ω load ƒë·ªông -->
            </select>

            <label>Character Sheet (t·ª± ƒë·ªông ƒëi·ªÅn khi ch·ªçn)</label>
            <textarea id="fixedCharacter" rows="6" readonly></textarea>

            <label>·∫¢nh Reference cho Video (upload ho·∫∑c link - ƒë·ªÉ lock nh√¢n v·∫≠t)</label>
            <input type="file" id="videoRefImage" accept="image/*">
            <input type="text" id="videoRefUrl" placeholder="https://example.com/ref.jpg">

            <label>H√†nh ƒë·ªông (bao g·ªìm t∆∞∆°ng t√°c n·∫øu nhi·ªÅu nh√¢n v·∫≠t)</label>
            <input type="text" id="action" placeholder="Nh√¢n v·∫≠t 1 nh·∫£y m√∫a v·ªõi nh√¢n v·∫≠t 2...">

            <label>C·∫£nh quan & kh√¥ng kh√≠</label>
            <textarea id="scene" rows="3" placeholder="V∆∞·ªùn hoa anh ƒë√†o ƒë√™m..."></textarea>

            <label>Style (ki·ªÉu video)</label>
            <select id="style">
                <option value="realistic">Ch√¢n th·∫≠t (Realistic)</option>
                <option value="cinematic">ƒêi·ªán ·∫£nh (Cinematic)</option>
                <option value="animation">Ho·∫°t h√¨nh (Animation)</option>
                <option value="cartoon">Truy·ªán tranh (Cartoon)</option>
                <option value="fantasy">K·ª≥ ·∫£o (Fantasy)</option>
            </select>

            <label>Aspect Ratio (t·ªâ l·ªá khung h√¨nh)</label>
            <select id="aspectRatio">
                <option value="720x1280 vertical (9:16)">D·ªçc (Vertical - TikTok/Reels)</option>
                <option value="1280x720 horizontal (16:9)">Ngang (Horizontal - YouTube)</option>
                <option value="1024x1024 square (1:1)">Vu√¥ng (Square - Instagram)</option>
            </select>

            <label>Th·ªùi l∆∞·ª£ng (gi√¢y)</label>
            <input type="text" id="duration" value="8">

            <label>√Çm thanh</label>
            <input type="text" id="audio" placeholder="Nh·∫°c n·ªÅn vui t∆∞∆°i">

            <label>API Key Veo 3 ho·∫∑c Kling AI (d√°n v√†o ƒë·ªÉ g·ª≠i t·ª± ƒë·ªông - hi·ªán placeholder)</label>
            <input type="text" id="apiKey" placeholder="D√°n API key ·ªü ƒë√¢y (hi·ªán kh√¥ng g·ª≠i ƒë∆∞·ª£c, c·∫ßn backend)">

            <button onclick="generateVideoPrompt()">üé• T·∫°o Prompt Video</button>
            <button onclick="sendToApi()" class="small-btn">üì§ G·ª≠i ƒë·∫øn API & L∆∞u Video</button>

            <div class="output" id="videoOutput"></div>
            <button class="copy-btn" onclick="copyToClipboard('videoOutput')">Copy Prompt</button>
        </div>

        <footer>Veo 3 Prompt Tool Pro v2 ‚Ä¢ Gi·ªù h·ªó tr·ª£ ƒëa nh√¢n v·∫≠t & API!</footer>
    </div>

    <script>
        let characters = JSON.parse(localStorage.getItem('veoCharacters')) || [];

        // C√°c h√†m gi·ªØ nguy√™n t·ª´ tr∆∞·ªõc, ch·ªâ th√™m m·ªõi
        function saveCharacters() {
            localStorage.setItem('veoCharacters', JSON.stringify(characters));
            renderCharacterList();
            updateCharacterSelect();
        }

        function renderCharacterList() {
            // Gi·ªØ nguy√™n
            const list = document.getElementById('characterList');
            list.innerHTML = '';
            characters.forEach((char, index) => {
                const card = document.createElement('div');
                card.className = 'char-card';
                card.innerHTML = `
                    <img src="${char.image}" alt="${char.name}">
                    <strong>${char.name}</strong>
                    <p>${char.sheet.substring(0, 60)}...</p>
                    <button onclick="deleteCharacter(${index})" style="background:#f44336;">X√≥a</button>
                `;
                list.appendChild(card);
            });
        }

        function updateCharacterSelect() {
            const select = document.getElementById('selectedCharacters');
            select.innerHTML = '';
            characters.forEach((char, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = char.name;
                select.appendChild(opt);
            });
        }

        function addOrUpdateCharacter() {
            // Gi·ªØ nguy√™n
            const name = document.getElementById('newCharName').value.trim();
            const userDesc = document.getElementById('userDesc').value.trim();
            if (!name) return alert("Nh·∫≠p t√™n!");
            const imageInput = document.getElementById('charImage');
            const imageUrl = document.getElementById('charImageUrl').value.trim();
            let imageSrc = "https://via.placeholder.com/300x400?text=No+Image";
            if (imageInput.files[0]) imageSrc = URL.createObjectURL(imageInput.files[0]);
            else if (imageUrl) imageSrc = imageUrl;
            const aiAnalysis = analyzeImageMock(imageSrc);
            const fullDesc = aiAnalysis + (userDesc ? " " + userDesc : "");
            const sheet = `Character: ${name} - ${fullDesc}. Keep exact same face, body, hairstyle, clothing across all scenes.`;
            characters.push({ name, image: imageSrc, sheet, fullDesc });
            saveCharacters();
            document.getElementById('analysisOutput').textContent = "Th√™m th√†nh c√¥ng!\n" + sheet;
        }

        function analyzeImageMock(imageSrc) {
            return "A young East Asian woman in her early 20s, long straight black hair with bangs, fair skin, big bright eyes, gentle smile, slim build, wearing traditional white Vietnamese √°o d√†i with delicate embroidery, elegant posture";
        }

        function analyzeImage() {
            // Gi·ªØ nguy√™n
        }

        function deleteCharacter(index) {
            if (confirm("X√≥a?")) {
                characters.splice(index, 1);
                saveCharacters();
            }
        }

        // H√†m m·ªõi: Load nhi·ªÅu Character Sheet
        document.getElementById('selectedCharacters').addEventListener('change', function() {
            const selected = Array.from(this.selectedOptions).map(opt => characters[opt.value].sheet);
            document.getElementById('fixedCharacter').value = selected.join('\n\n');
        });

        function generateVideoPrompt() {
            const sheet = document.getElementById('fixedCharacter').value.trim();
            if (!sheet) return alert("Ch·ªçn nh√¢n v·∫≠t tr∆∞·ªõc!");

            const refInput = document.getElementById('videoRefImage');
            const refUrl = document.getElementById('videoRefUrl').value.trim();
            let refSrc = "";
            if (refInput.files[0]) refSrc = URL.createObjectURL(refInput.files[0]);
            else if (refUrl) refSrc = refUrl;
            const refText = refSrc ? `\nUse the exact reference image for character appearance: ${refSrc}. No changes to face or proportions.` : "";

            const action = document.getElementById('action').value.trim() || "interacting naturally";
            const scene = document.getElementById('scene').value.trim() || "detailed environment";
            const duration = document.getElementById('duration').value || "8";
            const audio = document.getElementById('audio').value.trim() || "ambient sounds";
            const style = document.getElementById('style').value;
            const aspect = document.getElementById('aspectRatio').value;

            const prompt = `${sheet}${refText}

IMPORTANT: Maintain identical appearance for all characters. If multiple characters, they interact smoothly (e.g., talking, gesturing).

The characters are ${action} in a ${scene}, smooth movements, realistic physics.

Break down:
(0-2s) Introduce characters and scene.
(2-${parseInt(duration)-2}s) Main action with interactions.
(${parseInt(duration)-2}-${duration}s) Conclusion.

Style: ${style}.
Resolution: ${aspect}, ${duration} seconds.
Audio: ${audio}, synced with actions.`;

            document.getElementById('videoOutput').textContent = prompt;
        }

        function sendToApi() {
            const key = document.getElementById('apiKey').value.trim();
            const prompt = document.getElementById('videoOutput').textContent;
            if (!key || !prompt) return alert("C·∫ßn API key v√† prompt!");
            console.log("G·ª≠i ƒë·∫øn API: Key=", key, "Prompt=", prompt); // Placeholder - th√™m backend ƒë·ªÉ g·ª≠i th·∫≠t
            alert("Hi·ªán t·∫°i ch·ªâ log console (c·∫ßn backend ƒë·ªÉ g·ª≠i API th·∫≠t). Video s·∫Ω l∆∞u v·ªÅ n·∫øu th√†nh c√¥ng!");
        }

        function copyToClipboard(id) {
            const text = document.getElementById(id).textContent;
            navigator.clipboard.writeText(text).then(() => alert("Copy r·ªìi!"));
        }

        // Kh·ªüi ƒë·ªông
        renderCharacterList();
        updateCharacterSelect();
    </script>
</body>
</html>
