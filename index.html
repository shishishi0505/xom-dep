<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>üå∏ S·∫ÆC ƒê·∫∏P D√ÇN T·ªòC TH√ÅI üáπüá≠</title>
  
  <link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAWlBMVEUAAADu8u7x8fHx8fHx8fHu8u7u8u7x8fHx8fHu8u7x8fHx8fHx8fHu8u7u8u7u8u7x8fHx8fHx8fEAAADw8vH///+JvNfNAAAACnRSTlMA6wL66gMBDQECdYk870MAAACPSURVDjLrdLnEkAwEIXh/d84y4J+p6p7oP9Z4t8kM5kIeF3/eG8wYdIe7yX6A6h39v2xO80h59f8JcO7lPj/d4zD9y32R8Y8c4w8/x8L+d5E+N/g453fD732Vw448/D8P3fX+w411D5/x/l93wJ/f/i5b9/p+D9V5o/9t9797YcAAAAAElFTkSuQmCC">
  
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

  <style>
    :root {
      --primary-red: #8B0000;
      --secondary-gold: #FFD700;
      --text: #333333;
      --white: #ffffff;
      --cream: #fffaf0;
      --trans-white: rgba(255, 255, 255, 0.75); /* TƒÉng ƒë·ªô trong su·ªët */
      --trans-cream: rgba(255, 255, 255, 0.65);
      --blur-bg: blur(8px); /* M·ªù n·ªÅn nh·∫π */
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; font-family: 'Nunito', sans-serif; font-weight: 700; background-color: var(--cream); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed; color: var(--text); text-align: center; position: relative; }
    
    body.modal-open { position: fixed; width: 100%; overflow-y: scroll; padding-right: 0 !important; }

    header { margin-top: 30px; padding-bottom: 10px; z-index: 10; position: relative; }
    header h1 { margin: 12px 0 0; color: var(--white); font-size: 42px; letter-spacing: 1px; text-transform: uppercase; text-shadow: 1px 1px 4px rgba(0,0,0,0.7); }
    header p { margin: 6px 0 0; color: var(--white); font-size: 18px; font-weight: 800; text-shadow: 1px 1px 3px rgba(0,0,0,0.7); }

    .announcement {
        background: linear-gradient(135deg, var(--primary-red), #a00000);
        color: var(--white);
        padding: 16px 20px;
        margin: 20px auto;
        border-radius: 20px;
        max-width: 90%;
        box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        font-size: 17px;
        font-weight: 800;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        animation: pulse 2s infinite;
    }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

    .home-social a { width: 50px; height: 50px; border-radius: 50%; background: var(--primary-red); color: var(--white); font-size: 22px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); transition: all 0.3s; }
    .home-social a:hover { background: var(--secondary-gold); color: var(--primary-red); transform: translateY(-4px); }

    nav { background: var(--trans-white); backdrop-filter: var(--blur-bg); padding: 12px 14px; position: sticky; top: 14px; z-index: 40; margin: 0 10px; border-radius: 22px; box-shadow: 0 6px 18px rgba(0,0,0,0.1); }

    .layout { width: 95%; max-width: 1200px; margin: 30px auto; }
    .container { background: var(--trans-cream); backdrop-filter: var(--blur-bg); padding: 26px; border-radius: 30px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); }

    .card { background: var(--trans-cream); backdrop-filter: var(--blur-bg); border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 8px 30px rgba(0,0,0,0.08); }

    .product-card { background: var(--trans-white); backdrop-filter: var(--blur-bg); padding: 12px; border-radius: 18px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }

    .modal-content { background: var(--trans-white); backdrop-filter: var(--blur-bg); padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.4); }

    /* Box upload ·∫£nh ch·ª©ng t·ª´ trong su·ªët */
    #proof-upload-box { background: var(--trans-cream); backdrop-filter: var(--blur-bg); border-left: 4px solid var(--primary-red); }

    #order-form input, #order-form textarea { background: rgba(255,255,255,0.8); backdrop-filter: var(--blur-bg); }

    #qr-container canvas, #success-qr-container canvas { background: white; padding: 10px; border-radius: 12px; }

    .buy-button { width: 100%; padding: 15px; background: var(--primary-red); color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 900; cursor: pointer; margin: 15px 0; transition: 0.3s; }
    .buy-button:hover { background: #a00000; transform: translateY(-2px); }

    #order-success-section { display: none; text-align: center; margin: 30px 0; padding: 25px; background: rgba(0, 128, 0, 0.15); border-radius: 20px; border: 3px solid #008000; backdrop-filter: var(--blur-bg); }

    #zalo-float { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: #0088ff; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 999; animation: zaloPulse 2s infinite; }

    @media (max-width: 768px) { header h1 { font-size: 32px; } .product-grid { grid-template-columns: 1fr 1fr; } .modal-content { padding: 15px; border-radius: 0; width: 100%; height: 100vh; } }
  </style>
</head>
<body>
  <!-- (gi·ªØ nguy√™n header, nav, layout nh∆∞ tr∆∞·ªõc) -->

  <!-- Trong modal -->
  <div id="order-form-section" style="margin-top:20px;">
    <h3 style="color:var(--primary-red);">TH√îNG TIN ƒê·∫∂T H√ÄNG</h3>
    <form id="order-form">
      <!-- C√°c input gi·ªØ nguy√™n -->

      <div id="proof-upload-box" style="margin:20px 0; padding:15px; border-radius:12px; text-align:left;">
        <!-- N·ªôi dung box upload ·∫£nh gi·ªØ nguy√™n -->
      </div>

      <div id="qr-container" style="margin:25px 0;"></div>
      <p style="font-weight:800;">Chuy·ªÉn kho·∫£n c·ªçc: <span id="deposit-amount" style="color:var(--primary-red); font-size:18px;"></span></p>

      <button type="submit" class="buy-button" id="submit-order-btn">
        <i class="fas fa-paper-plane"></i> HO√ÄN T·∫§T ƒê·∫∂T H√ÄNG
      </button>
    </form>

    <div id="order-success-section">
      <!-- N·ªôi dung th√†nh c√¥ng gi·ªØ nguy√™n -->
    </div>
  </div>

  <!-- B·ªè n√∫t "MUA NGAY" v√¨ kh√¥ng c·∫ßn n·ªØa -->

  <script>
    // Trong openProductModal(product)
    function openProductModal(product) {
      // ... gi·ªØ nguy√™n ph·∫ßn ƒë·∫ßu

      document.getElementById('order-form-section').style.display = 'block';
      document.getElementById('order-form').style.display = 'block';
      document.getElementById('order-success-section').style.display = 'none';

      // T·∫†O QR NGAY KHI M·ªû MODAL
      const price = Number(product.price?.replace(/[^0-9]/g,'') || 0);
      const deposit = Math.round(price * 0.5);
      document.getElementById('deposit-amount').textContent = deposit.toLocaleString() + ' VNƒê';

      const orderId = product.id.toUpperCase() + Math.floor(1000 + Math.random() * 9000);
      document.getElementById('customer-name').dataset.orderId = orderId;

      const bankId = (CONFIG.bank_id || 'tpbank').toLowerCase();
      const account = CONFIG.bank_account || '';
      const name = encodeURIComponent(CONFIG.bank_name || '');
      const content = encodeURIComponent(`${product.id.toUpperCase()}-${orderId}`);
      const qrUrl = `https://img.vietqr.io/image/${bankId}-${account}-compact2.png?amount=${deposit}&addInfo=${content}&accountName=${name}`;

      const canvas = document.createElement('canvas');
      document.getElementById('qr-container').innerHTML = '';
      document.getElementById('qr-container').appendChild(canvas);
      QRCode.toCanvas(canvas, qrUrl, { width: 280 }, err => {
        if (err) console.error(err);
      });

      modal.classList.add('visible');
      document.body.classList.add('modal-open');
    }

    // Ph·∫ßn submit gi·ªØ nguy√™n nh∆∞ file tr∆∞·ªõc (sau th√†nh c√¥ng t·∫°o QR l·ªõn h∆°n)
  </script>
</body>
</html>
