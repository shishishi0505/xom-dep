<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üå∏ S·∫ÆC ƒê·∫∏P D√ÇN T·ªòC</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <style>
    :root {
      --primary-red: #8B0000;
      --secondary-gold: #FFD700;
      --trans-white: rgba(255, 255, 255, 0.4); 
      --trans-cream: rgba(255, 255, 255, 0.25);
      --blur-bg: blur(12px);
    }

    .menu-toggle {
        position: fixed; top: 20px; right: 20px; z-index: 1001;
        background: var(--primary-red); color: white; width: 45px; height: 45px;
        border-radius: 10px; display: flex; align-items: center; justify-content: center;
        cursor: pointer; font-size: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .menu-note {
        position: fixed; top: 75px; right: 20px; z-index: 1000;
        background: rgba(0,0,0,0.6); color: white; padding: 8px 12px;
        border-radius: 10px; font-size: 13px; text-align: center;
    }
    .success-popup {
        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        background: white; padding: 30px; border-radius: 20px; text-align: center;
        z-index: 3000; box-shadow: 0 0 30px rgba(0,0,0,0.5); display: none; width: 90%; max-width: 400px;
    }
    .countdown { font-size: 14px; color: #666; margin-top: 10px; }

    .history-card {
        background: rgba(255,255,255,0.1); border-radius: 15px; padding: 15px;
        margin-bottom: 10px; border-left: 5px solid var(--secondary-gold); text-align: left; color: white;
    }

    .blog-post-full { text-align: left; line-height: 1.8; color: #ffffff; font-size: 17px; padding: 30px; background: rgba(0, 0, 0, 0.4); border-radius: 25px; margin-top: 20px; border: 1px solid var(--secondary-gold); }
    .blog-post-full img { max-width: 100%; height: auto; border-radius: 15px; margin: 20px auto; display: block; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    body { font-family: 'Nunito', sans-serif; margin: 0; background-attachment: fixed; background-size: cover; background-position: center; color: #333; transition: 0.5s; }
    header { padding: 40px 20px 10px; text-align: center; }
    header h1 { font-size: clamp(28px, 5vw, 42px); color: white; text-shadow: 2px 2px 10px rgba(0,0,0,0.8); margin: 0; }
    nav { background: var(--trans-white); backdrop-filter: var(--blur-bg); padding: 10px; position: sticky; top: 0; z-index: 100; display: flex; justify-content: center; gap: 10px; }
    nav a { text-decoration: none; color: var(--primary-red); font-weight: 900; padding: 8px 15px; border-radius: 15px; }
    nav a.active { background: var(--primary-red); color: white; }
    .layout { width: 95%; max-width: 1200px; margin: 20px auto; }
    .card { background: var(--trans-cream); backdrop-filter: var(--blur-bg); border-radius: 25px; padding: 25px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.2); text-align: center; }
    .social-under-poem { margin-top: 20px; display: flex; justify-content: center; gap: 25px; }
    .social-under-poem a { color: var(--secondary-gold); font-size: 28px; text-shadow: 1px 1px 5px black; }
    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; margin-top: 20px; }
    .product-card { background: var(--trans-white); backdrop-filter: var(--blur-bg); padding: 15px; border-radius: 20px; cursor: pointer; transition: 0.3s; }
    .product-card img { width: 100%; border-radius: 15px; aspect-ratio: 1/1; object-fit: cover; }
    .tag-id { background: var(--primary-red); color: white; font-size: 10px; padding: 2px 8px; border-radius: 5px; }
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 2000; padding: 10px; }
    .modal-content { background: white; border-radius: 25px; width: 100%; max-width: 900px; max-height: 95vh; overflow-y: auto; position: relative; }
    .modal-body { padding: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
    .gallery-main { width: 100%; border-radius: 15px; transition: 0.3s; }
    .thumb-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px; }
    .thumb-grid img { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 8px; cursor: pointer; opacity: 0.6; }
    .order-form input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
    .btn-action { background: #28a745; color: white; border: none; padding: 15px; width: 100%; border-radius: 12px; font-weight: 800; cursor: pointer; margin-top: 10px; }
    .hidden { display: none; }
    .zalo-float { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; z-index: 999; animation: ring 2s infinite; }
    @keyframes ring { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1) rotate(10deg); } }

    /* Th√™m style cho k·∫øt qu·∫£ tra c·ª©u chi ti·∫øt */
    .order-detail {
        background: white; color: black; padding: 20px; border-radius: 15px; text-align: left; line-height: 1.8;
    }
    .order-detail b { color: var(--primary-red); }
  </style>
</head>
<body>

  <div class="menu-toggle" onclick="toggleHistory()"><i class="fas fa-bars"></i></div>
  <div class="menu-note">Tra l·ªãch s·ª≠<br>ƒë·∫∑t h√†ng</div>

  <header><h1>S·∫ÆC ƒê·∫∏P D√ÇN T·ªòC</h1></header>

  <nav id="navbar">
    <a href="#home" class="nav-link active">TRANG CH·ª¶</a>
    <a href="#products" class="nav-link">S·∫¢N PH·∫®M</a>
    <a href="#tracking" class="nav-link">TRA C·ª®U</a>
  </nav>

  <div class="layout">
    <section id="history-section" class="card hidden">
        <h2 style="color: var(--secondary-gold);">üìú L·ªäCH S·ª¨ ƒê·∫∂T H√ÄNG</h2>
        <p style="color:white">Nh·∫≠p SƒêT v√† T√™n ƒë·ªÉ xem l·∫°i to√†n b·ªô ƒë∆°n h√†ng</p>
        <input type="text" id="hist-name" placeholder="H·ªç v√† t√™n" style="padding:12px; border-radius:10px; width:220px; border:1px solid #ddd; margin-bottom:8px;">
        <input type="tel" id="hist-phone" placeholder="S·ªë ƒëi·ªán tho·∫°i" style="padding:12px; border-radius:10px; width:220px; border:1px solid #ddd;">
        <button onclick="loadHistory()" class="btn-action" style="width:auto; padding:12px 25px; margin-top:10px;">XEM L·ªäCH S·ª¨</button>
        <div id="hist-res" style="margin-top:20px;"></div>
    </section>

    <section id="home" class="card">
        <h2 style="color: var(--secondary-gold);">üå∏ CHUY·ªÜN B·∫¢N L√ÄNG</h2>
        <div id="blog-content" class="blog-post-full">ƒêang k·∫øt n·ªëi t·ªõi b·∫£n l√†ng...</div>
        <div class="social-under-poem" id="home-socials"></div>
    </section>

    <section id="products" class="card hidden">
        <h2>S·∫¢N PH·∫®M M·ªöI NH·∫§T</h2>
        <div class="product-grid" id="product-list"></div>
    </section>

    <section id="tracking" class="card hidden">
        <h2>TRA C·ª®U ƒê∆†N H√ÄNG</h2>
        <input type="text" id="track-input" placeholder="Nh·∫≠p m√£ ƒë∆°n (VD: SDT1234)" style="padding:12px; border-radius:10px; width:250px; border:1px solid #ddd;">
        <button onclick="checkOrder()" class="btn-action" style="width:auto; padding:12px 30px;">T√åM KI·∫æM</button>
        <div id="track-res" style="margin-top:20px;"></div>
    </section>
  </div>

  <div id="success-dialog" class="success-popup">
      <div style="font-size: 50px; color: #28a745; margin-bottom: 15px;"><i class="fas fa-check-circle"></i></div>
      <h3 style="margin: 0; color: #333;">G·ª¨I ƒê∆†N TH√ÄNH C√îNG!</h3>
      <p style="color: #666; font-size: 14px; line-height: 1.5; margin: 15px 0;">
          H·ªá th·ªëng ƒë√£ ghi nh·∫≠n ƒë∆°n h√†ng.<br>B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o x√°c nh·∫≠n qua Zalo/Email s·ªõm nh·∫•t.
      </p>
      <button class="btn-action" onclick="closeSuccess()">ƒê√ìNG</button>
      <div class="countdown">T·ª± ƒë·ªông ƒë√≥ng sau <span id="countdown-timer">10</span>s</div>
  </div>

  <div id="product-modal" class="modal-overlay">
      <div class="modal-content">
          <span style="position:absolute; top:15px; right:20px; font-size:30px; cursor:pointer; z-index:10;" onclick="closeModal()">&times;</span>
          
          <div class="modal-body" id="step-1">
              <!-- Gi·ªØ nguy√™n n·ªôi dung modal nh∆∞ c≈© (b·∫°n ƒë√£ truncate n√™n t√¥i kh√¥ng paste l·∫°i to√†n b·ªô ƒë·ªÉ ti·∫øt ki·ªám) -->
          </div>
          <!-- C√°c step 2, 3 gi·ªØ nguy√™n -->
      </div>
  </div>

  <script>
    // Gi·ªØ nguy√™n to√†n b·ªô bi·∫øn v√† h√†m c≈©...

    let countdownInterval;

    function displayPost(index) {
        const post = ALL_POSTS[index];
        const contentDiv = document.getElementById('blog-content');
        let html = `<h1 style="font-size: 22px; margin:0;">${post.title}</h1>
                    <p style="font-size:12px; color:var(--secondary-gold); margin-bottom:15px;">Ng√†y: ${new Date(post.pubDate).toLocaleDateString('vi-VN')}</p>`;
        
        if (ALL_POSTS.length > 1) {
            html += `<div style="margin-bottom:20px; padding:10px; background:rgba(255,255,255,0.05); border-radius:15px;">
                    <p style="font-size:12px; color:var(--secondary-gold); margin:0 0 5px 0;">B√ÄI VI·∫æT KH√ÅC:</p>`;
            ALL_POSTS.forEach((p, i) => {
                if (i !== index) {
                    html += `<div onclick="displayPost(${i}); window.scrollTo(0,0);" style="cursor:pointer; padding:5px; color:#eee;">
                                <h4 style="margin:0; font-size:14px; font-weight:normal;">‚Ä¢ ${p.title}</h4>
                            </div>`;
                }
            });
            html += `</div>`;
        }
        html += `<div class="post-body-content">${post.content}</div>`;
        contentDiv.innerHTML = html;
    }

    async function checkOrder() {
        const id = document.getElementById('track-input').value.toUpperCase().trim();
        if(!id) return alert("Vui l√≤ng nh·∫≠p m√£ ƒë∆°n!");
        const resDiv = document.getElementById('track-res');
        resDiv.innerHTML = "ƒêang tra c·ª©u...";
        try {
            const response = await fetch(URLS.track);
            const text = await response.text();
            const orders = Papa.parse(text, { header: true, delimiter: '\t', skipEmptyLines: true }).data;
            const found = orders.find(o => (o["M√£ ƒë∆°n h√†ng"] || o["order_id"] || "").toUpperCase() === id);
            if(found) { 
                resDiv.innerHTML = `<div class="order-detail">
                    <b>Ng√†y ƒë·∫∑t:</b> ${found["Ng√†y ƒë·∫∑t"] || "Kh√¥ng c√≥"}<br>
                    <b>M√£ ƒë∆°n h√†ng:</b> ${found["M√£ ƒë∆°n h√†ng"] || found["order_id"] || "Kh√¥ng c√≥"}<br>
                    <b>T√™n kh√°ch h√†ng:</b> ${found["T√™n kh√°ch h√†ng"] || "Kh√¥ng c√≥"}<br>
                    <b>S·ªë ƒëi·ªán tho·∫°i:</b> ${found["S·ªë ƒëi·ªán tho·∫°i"] || "Kh√¥ng c√≥"}<br>
                    <b>Gmail/Zalo:</b> ${found["Gmail/Zalo"] || "Kh√¥ng c√≥"}<br>
                    <b>ƒê·ªãa ch·ªâ:</b> ${found["ƒê·ªãa ch·ªâ"] || "Kh√¥ng c√≥"}<br>
                    <b>T·ªïng ti·ªÅn:</b> ${found["T·ªïng ti·ªÅn"] || "Kh√¥ng c√≥"}<br>
                    <b>Tr·∫°ng th√°i:</b> ${found["Tr·∫°ng th√°i"] || "ƒêang x·ª≠ l√Ω"}<br>
                    <b>Ti·∫øn ƒë·ªô:</b> ${found["Ti·∫øn ƒë·ªô"] || "Ch∆∞a c√≥ th√¥ng tin"}<br>
                    <b>Ghi ch√∫:</b> ${found["Ghi ch√∫"] || "Kh√¥ng c√≥"}
                </div>`; 
            } else { 
                resDiv.innerHTML = "<p style='color:red'>Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng n√†y!</p>"; 
            }
        } catch(e) {
            resDiv.innerHTML = "<p style='color:red'>L·ªói k·∫øt n·ªëi, vui l√≤ng th·ª≠ l·∫°i!</p>";
        }
    }

    // H√†m x·ª≠ l√Ω chuy·ªÉn tab v√† l√†m m·ªõi input
    document.querySelectorAll('.nav-link').forEach(l => {
        l.onclick = (e) => {
            e.preventDefault();
            document.querySelectorAll('section.card').forEach(s => s.classList.add('hidden'));
            const target = document.querySelector(l.getAttribute('href'));
            target.classList.remove('hidden');
            document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
            l.classList.add('active');

            // L√†m m·ªõi c√°c √¥ input khi chuy·ªÉn tab
            document.getElementById('track-input').value = '';
            document.getElementById('hist-name').value = '';
            document.getElementById('hist-phone').value = '';
            document.getElementById('track-res').innerHTML = '';
            document.getElementById('hist-res').innerHTML = '';
        };
    });

    // S·ª≠a ch·ªß t√†i kho·∫£n QR
    document.getElementById('bank-owner').innerText = "TONG ANH NAM";

    // C√°c h√†m kh√°c gi·ªØ nguy√™n (renderProducts, openProduct, processPayment, finalSubmit, v.v.)
  </script>
</body>
</html>
